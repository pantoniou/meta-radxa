#@TYPE: Machine
#@NAME: RockPi-S machine
#@DESCRIPTION: RockPi-S development board config file

SOC_FAMILY = "rk3308"

DEFAULTTUNE ?= "cortexa35-crypto"
require conf/machine/include/tune-cortexa35.inc
require conf/machine/include/soc-family.inc

MACHINEOVERRIDES =. "mali-gpu:mali-midgard:"

PREFERRED_PROVIDER_virtual/kernel = "linux-rockpi-s"
PREFERRED_VERSION_linux-rockchip = "4.4"

SERIAL_CONSOLES = "1500000;ttyS0"
KERNEL_IMAGETYPE = "Image"
KBUILD_DEFCONFIG = "rk3308_linux_defconfig"

PREFERRED_PROVIDER_virtual/bootloader ?= "u-boot-rockpi-s"

KERNEL_DEVICETREE = "rockchip/rk3308-rock-pi-s.dtb"
UBOOT_MACHINE = "rock-pi-s-rk3308_defconfig"

MACHINE_ESSENTIAL_EXTRA_RRECOMMENDS += "\
   kernel-modules \
   rtl-tools \
   rkwifibt-firmware-rtl8723ds-bt \
"
IMAGE_FSTYPES += "rockchip-radxa-gpt-img"
IMAGE_CLASSES += "rockchip-radxa-gpt-img"

WKS_FILE ?= "sdimage-rockpi-s.wks"

do_image_wic[depends] += " \
   radxa-binaries:do_deploy \
   "

IMAGE_BOOT_FILES ?= " \
   boot.cmd \
   boot.scr \
   Image \
   rk3308-rock-pi-s.dtb \
   uEnv.txt \
   overlays/rk3308-console-on-uart0.dtbo \
   overlays/rk3308-console-on-uart1.dtbo \
   overlays/rk3308-console-on-uart2.dtbo \
   overlays/rk3308-i2c0.dtbo \
   overlays/rk3308-i2c1.dtbo \
   overlays/rk3308-i2c2.dtbo \
   overlays/rk3308-i2c3.dtbo \
   overlays/rk3308-pwm1.dtbo \
   overlays/rk3308-pwm2.dtbo \
   overlays/rk3308-pwm3.dtbo \
   overlays/rk3308-spi-spidev.dtbo \
   overlays/rk3308-uart0.dtbo \
   overlays/rk3308-uart1.dtbo \
   overlays/rk3308-uart2.dtbo \
   overlays/rk3308-w1-gpio.dtbo \
   overlays/rockpis-spi2-waveshare35b-v2.dtbo \
   overlays/rockpis-spi2-waveshare35c.dtbo \
   overlays/rockchip-fixup.scr \
   "
